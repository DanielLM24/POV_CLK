MPASM 5.65                         RELOJ.ASM   2-29-2016  22:18:30         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;Universidad del Valle de Guatemala
                      00002 ;Microcontroladores Aplicados a la Industria
                      00003 ;Sección 21
                      00004 ;Daniel Lara Moir
                      00005 ;13424
                      00006 ;Reloj.asm   
                      00007 ;Programa para reloj en formato 24h HH:MM:SS.   
                      00008         
Warning[205]: Found directive in column 1. (list)
                      00009 list      p=16F84A            ; list directive to define processor
                      00010 #include <p16F84A.inc>        ; processor specific variable definitions
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ; Build date : Dec 08 2015
                      00005 ;  MPASM PIC16F84A processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2015 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      00209         LIST
                      00011 
Warning[205]: Found directive in column 1. (__CONFIG)
2007   3FF1           00012 __CONFIG   _CP_OFF & _WDT_OFF & _PWRTE_ON & _XT_OSC
                      00013     
                      00014 ;***************VARIABLE DEFINITION*********************************************
Warning[205]: Found directive in column 1. (UDATA_SHR)
                      00015 UDATA_SHR 0x0C
  00000020            00016 w_temp          EQU     0x20            ; variable used for context saving
  000000A0            00017 w_temp1         EQU     0xA0            ; reserve bank1 equivalent of w_temp 
  00000021            00018 status_temp     EQU     0x21            ; variable used for context saving
  00000022            00019 pclath_temp     EQU     0x22            ; variable used for context saving
000C                  00020 delay_counter   res 1                   ; For one second delay.
000D                  00021 seconds         res 1                   ; Variables for time storage.
000E                  00022 seconds_t       res 1   
000F                  00023 seconds_u       res 1
0010                  00024 minutes         res 1
0011                  00025 minutes_t       res 1
0012                  00026 minutes_u       res 1
0013                  00027 hours           res 1
0014                  00028 hours_t         res 1
0015                  00029 hours_u         res 1
0016                  00030 alarm_minutes   res 1                   ; Variables for alarm setting.
0017                  00031 alarm_hours     res 1
                      00032 ;*******************************************************************************
Warning[205]: Found directive in column 1. (ORG)
                      00033 ORG 0x0000
0000   0000           00034     NOP
0001   2???           00035     GOTO SETUP
                      00036 ;*******************************************************************************
Warning[205]: Found directive in column 1. (ORG)
                      00037 ORG 0x0004
Warning[207]: Found label after column 1. (PUSH)
MPASM 5.65                         RELOJ.ASM   2-29-2016  22:18:30         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0004                  00038     PUSH:
0004   00A0           00039         movwf   w_temp            ; save off current W register contents
0005   0803           00040         movf    STATUS,w          ; move status register into W register
0006   1283           00041         bcf     STATUS,RP0        ; ensure file register bank set to 0
0007   00A1           00042         movwf   status_temp       ; save off contents of STATUS register
0008   080A           00043         movf    PCLATH,w          ; move pclath register into w register
0009   00A2           00044         movwf   pclath_temp       ; save off contents of PCLATH register
                      00045 
                      00046 ;********TMR0 INTERRUPTION**************************************************
000A   1D0B           00047         BTFSS INTCON, T0IF        ; Check T0IF.
000B   2???           00048         GOTO RBI                  ; Exit interrupt vector. 
000C   110B           00049         BCF INTCON, T0IF
000D   303D           00050         MOVLW .61                 ; Pre-load TMR0
000E   0081           00051         MOVWF TMR0
000F   158B           00052         BSF INTCON, RBIE        
                      00053 
0010   0B??           00054         DECFSZ delay_counter, 1   ; 1 second has passed.
0011   2???           00055         GOTO POP
                      00056         
0012   3028           00057         MOVLW .40                   ; For 1 second delay.
0013   00??           00058         MOVWF delay_counter     
0014   2???           00059         GOTO SECONDS_INCREMENT
                      00060         
Warning[207]: Found label after column 1. (RBI)
0015                  00061     RBI:
0015   1C0B           00062         BTFSS INTCON, RBIF          ; Interrupt not caused by button press.
0016   2???           00063         GOTO POP
0017   100B           00064         BCF INTCON, RBIF            ; Interrupt flag clear.
                      00065         
Warning[207]: Found label after column 1. (CHECK_ALARM_SET)
0018                  00066         CHECK_ALARM_SET:
0018   1F06           00067             BTFSS PORTB, RB6
0019   2???           00068             GOTO CHECK_MINUTES_INC
001A   1805           00069             BTFSC PORTA,0               
001B   2???           00070             GOTO second_hand_on 
001C   1405           00071             BSF PORTA,0                 ; Enciende el LED
001D   2???           00072             GOTO CHECK_MINUTES_INC
Warning[207]: Found label after column 1. (second_hand_on)
001E                  00073             second_hand_on:
001E   1005           00074             BCF PORTA,0 
Warning[207]: Found label after column 1. (CHECK_MINUTES_INC)
001F                  00075         CHECK_MINUTES_INC:
001F   1A06           00076             BTFSC PORTB, RB4
0020   2???           00077             GOTO MINUTES_INCREMENT
Warning[207]: Found label after column 1. (CHECK_HOURS_INC)
0021                  00078         CHECK_HOURS_INC:  
0021   1A86           00079             BTFSC PORTB, RB5
0022   2???           00080             GOTO HOURS_INCREMENT
0023   2???           00081             GOTO POP
                      00082         
                      00083            
                      00084             
                      00085         
MPASM 5.65                         RELOJ.ASM   2-29-2016  22:18:30         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[207]: Found label after column 1. (SECONDS_DISPLAY)
0024                  00086         SECONDS_DISPLAY:
                      00087         ;    BTFSC PORTA,0              
                      00088          ;   GOTO second_hand_on        
                      00089           ;  BSF PORTA,0                        ; Apaga el LED
                      00090            ; GOTO SECONDS_INCREMENT
                      00091             ;second_hand_on:
                      00092              ;   BCF PORTA,0                    ; Enciende el LED 
                      00093         
Warning[207]: Found label after column 1. (SECONDS_INCREMENT)
0024                  00094         SECONDS_INCREMENT:
0024   0A??           00095             INCF seconds, f                     ; Circular increment of seconds.
0025   08??           00096             MOVF seconds, 0
0026   3C3C           00097             SUBLW .60
0027   1D03           00098             BTFSS STATUS, Z
0028   2???           00099             GOTO POP
0029   3000           00100             MOVLW .0
002A   00??           00101             MOVWF seconds
                      00102 
Warning[207]: Found label after column 1. (MINUTES_DISPLAY)
002B                  00103         MINUTES_DISPLAY:
                      00104             ;BTFSC PORTA, 1
                      00105             ;GOTO minute_hand_on
                      00106             ;BSF PORTA, 1
                      00107             ;GOTO MINUTES_INCREMENT
                      00108             ;minute_hand_on:
                      00109         ;       BCF PORTA, 1
                      00110                 
Warning[207]: Found label after column 1. (MINUTES_INCREMENT)
002B                  00111         MINUTES_INCREMENT:
002B   0A??           00112             INCF minutes, f                     ; Circular increment of minutes.        
002C   08??           00113             MOVF minutes, 0
002D   3C3C           00114             SUBLW .60
002E   1D03           00115             BTFSS STATUS, Z
002F   2???           00116             GOTO POP
0030   3000           00117             MOVLW .0
0031   00??           00118             MOVWF minutes
                      00119         
Warning[207]: Found label after column 1. (HOURS_DISPLAY)
0032                  00120         HOURS_DISPLAY:
                      00121          ;   BTFSC PORTA, 2
                      00122           ;  GOTO hour_hand_on
                      00123            ; BSF PORTA, 2
                      00124             ;GOTO HOURS_INCREMENT
                      00125             ;hour_hand_on:
                      00126         ;       BCF PORTA, 2
                      00127         
Warning[207]: Found label after column 1. (HOURS_INCREMENT)
0032                  00128         HOURS_INCREMENT:
0032   0A??           00129             INCF hours, f                       ; Circular increment of hours.
0033   08??           00130             MOVF hours, 0
0034   3C18           00131             SUBLW .24
0035   1D03           00132             BTFSS STATUS, Z
MPASM 5.65                         RELOJ.ASM   2-29-2016  22:18:30         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0036   2???           00133             GOTO POP
0037   3000           00134             MOVLW .0
0038   00??           00135             MOVWF hours
                      00136 ;*******EXIT INTERRUPT VECTOR***********************************************        
Warning[207]: Found label after column 1. (POP)
0039                  00137     POP:
0039   1283           00138         bcf     STATUS,RP0        ; ensure file register bank set to 0
003A   0822           00139         movf    pclath_temp,w     ; retrieve copy of PCLATH register
003B   008A           00140         movwf   PCLATH            ; restore pre-isr PCLATH register contents
003C   0821           00141         movf    status_temp,w     ; retrieve copy of STATUS register
003D   0083           00142         movwf   STATUS            ; restore pre-isr STATUS register contents
003E   0EA0           00143         swapf   w_temp,f
003F   0E20           00144         swapf   w_temp,w          ; restore pre-isr W register contents
0040   0009           00145         RETFIE
                      00146 ;*******************************************************************************
                      00147     
0041                  00148 SETUP:
0041   1683           00149     BSF STATUS, RP0             ; Bank select 1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0042   0185           00150     CLRF TRISA       
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0043   0186           00151     CLRF TRISB       
0044   30F0           00152     MOVLW b'11110000'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0045   0086           00153     MOVWF TRISB
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0046   0185           00154     CLRF TRISA
0047   30A8           00155     MOVLW b'10101000'           ; Enables interrupts from TMR0 an RB (IOC).
0048   008B           00156     MOVWF INTCON
                      00157             
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0049   1281           00158     BCF OPTION_REG, T0CS        ; TMR0 CLOCK SOURCE: INTERNAL INSTRUCTION CYCLE CLOCK
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004A   1181           00159     BCF OPTION_REG, PSA         ; PRESCALER ASSIGNMENT: TIMER0 MODULE
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004B   1501           00160     BSF OPTION_REG, PS2         ; PRESCALER RATE: 1:256
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004C   1481           00161     BSF OPTION_REG, PS1         ; PRESCALER RATE: 1:256
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004D   1401           00162     BSF OPTION_REG, PS0         ; PRESCALER RATE: 1:256
                      00163 
004E   1283           00164     BCF STATUS, RP0             ; bank select 1 
004F   0185           00165     CLRF PORTA                  
0050   0186           00166     CLRF PORTB
                      00167     
0051   3028           00168     MOVLW .40                   ; For TMR0 delay of 1000ms 
0052   00??           00169     MOVWF delay_counter
                      00170     
0053   300F           00171     MOVLW .15                   ; Initial time.
0054   00??           00172     MOVWF seconds
0055   00??           00173     MOVWF minutes
0056   00??           00174     MOVWF hours
                      00175     
MPASM 5.65                         RELOJ.ASM   2-29-2016  22:18:30         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00176 
                      00177     
0057                  00178 MAINPROGRAM:
0057   2???           00179     CALL SPLIT_SECONDS          ; Call to get HH:MM:SS
0058   2???           00180     CALL SPLIT_MINUTES
0059   2???           00181     CALL SPLIT_HOURS
005A   2???           00182     GOTO MAINPROGRAM            ; Unconditional loop.
                      00183     
005B                  00184 SPLIT_SECONDS:                          ; Splits digits.
005B   08??           00185     MOVF seconds, 0         
005C   00??           00186     MOVWF seconds_u
005D   01??           00187     CLRF seconds_t
Warning[207]: Found label after column 1. (SPLIT_SECONDS_LOOP)
005E                  00188     SPLIT_SECONDS_LOOP:                 ; Succesive substraction algorithm.
005E   300A           00189         MOVLW .10
005F   02??           00190         SUBWF seconds_u, f
0060   1903           00191         BTFSC STATUS, Z                 ; Check for zero in result. 
0061   2???           00192         GOTO SPLIT_SECONDS_ZERO
0062   1C03           00193         BTFSS STATUS, C                 ; Check for underflow.
0063   2???           00194         GOTO SPLIT_SECONDS_BORROW
Message[305]: Using default destination of 1 (file).
0064   0A??           00195         INCF seconds_t                  ; If none of the above -> increment.
0065   2???           00196         GOTO SPLIT_SECONDS_LOOP         ; Loop.
Warning[207]: Found label after column 1. (SPLIT_SECONDS_ZERO)
0066                  00197     SPLIT_SECONDS_ZERO:
0066   0A??           00198         INCF seconds_t, f               ; Increment and exit.
0067   0008           00199         RETURN
Warning[207]: Found label after column 1. (SPLIT_SECONDS_BORROW)
0068                  00200     SPLIT_SECONDS_BORROW:
0068   300A           00201         MOVLW .10                       ; Restore original value and exit.
0069   07??           00202         ADDWF seconds_u, f
006A   0008           00203         RETURN
                      00204 
006B                  00205 SPLIT_MINUTES:
006B   08??           00206     MOVF minutes, 0
006C   00??           00207     MOVWF minutes_u
006D   01??           00208     CLRF minutes_t
Warning[207]: Found label after column 1. (SPLIT_MINUTES_LOOP)
006E                  00209     SPLIT_MINUTES_LOOP:
006E   300A           00210         MOVLW .10
006F   02??           00211         SUBWF minutes_u, f
0070   1903           00212         BTFSC STATUS, Z
0071   2???           00213         GOTO SPLIT_MINUTES_ZERO
0072   1C03           00214         BTFSS STATUS, C
0073   2???           00215         GOTO SPLIT_MINUTES_BORROW
Message[305]: Using default destination of 1 (file).
0074   0A??           00216         INCF minutes_t
0075   2???           00217         GOTO SPLIT_MINUTES_LOOP
Warning[207]: Found label after column 1. (SPLIT_MINUTES_ZERO)
0076                  00218     SPLIT_MINUTES_ZERO:
0076   0A??           00219         INCF minutes_t, f 
0077   0008           00220         RETURN
Warning[207]: Found label after column 1. (SPLIT_MINUTES_BORROW)
MPASM 5.65                         RELOJ.ASM   2-29-2016  22:18:30         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0078                  00221     SPLIT_MINUTES_BORROW:
0078   300A           00222         MOVLW .10
0079   07??           00223         ADDWF minutes_u, f
007A   0008           00224         RETURN
                      00225         
007B                  00226 SPLIT_HOURS:
007B   08??           00227     MOVF hours, 0
007C   00??           00228     MOVWF hours_u
007D   01??           00229     CLRF hours_t
Warning[207]: Found label after column 1. (SPLIT_HOURS_LOOP)
007E                  00230     SPLIT_HOURS_LOOP:
007E   300A           00231         MOVLW .10
007F   02??           00232         SUBWF hours_u, f
0080   1903           00233         BTFSC STATUS, Z
0081   2???           00234         GOTO SPLIT_HOURS_ZERO
0082   1C03           00235         BTFSS STATUS, C
0083   2???           00236         GOTO SPLIT_HOURS_BORROW
Message[305]: Using default destination of 1 (file).
0084   0A??           00237         INCF hours_t
0085   2???           00238         GOTO SPLIT_HOURS_LOOP
Warning[207]: Found label after column 1. (SPLIT_HOURS_ZERO)
0086                  00239     SPLIT_HOURS_ZERO:
0086   0A??           00240         INCF hours_t, f 
0087   0008           00241         RETURN
Warning[207]: Found label after column 1. (SPLIT_HOURS_BORROW)
0088                  00242     SPLIT_HOURS_BORROW:
0088   300A           00243         MOVLW .10
0089   07??           00244         ADDWF hours_u, f
008A   0008           00245         RETURN
                      00246         
Warning[205]: Found directive in column 1. (END)
3FF1                  00247 END
MPASM 5.65                         RELOJ.ASM   2-29-2016  22:18:30         PAGE  7


SYMBOL TABLE
  LABEL                             VALUE 

C                                 00000000
CHECK_ALARM_SET                   00000018
CHECK_HOURS_INC                   00000021
CHECK_MINUTES_INC                 0000001F
DC                                00000001
EEADR                             00000009
EECON1                            00000088
EECON2                            00000089
EEDATA                            00000008
EEIE                              00000006
EEIF                              00000004
F                                 00000001
FSR                               00000004
GIE                               00000007
HOURS_DISPLAY                     00000032
HOURS_INCREMENT                   00000032
INDF                              00000000
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IRP                               00000007
MAINPROGRAM                       00000057
MINUTES_DISPLAY                   0000002B
MINUTES_INCREMENT                 0000002B
NOT_PD                            00000003
NOT_RBPU                          00000007
NOT_TO                            00000004
OPTION_REG                        00000081
PCL                               00000002
PCLATH                            0000000A
POP                               00000039
PORTA                             00000005
PORTB                             00000006
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PUSH                              00000004
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBI                               00000015
MPASM 5.65                         RELOJ.ASM   2-29-2016  22:18:30         PAGE  8


SYMBOL TABLE
  LABEL                             VALUE 

RBIE                              00000003
RBIF                              00000000
RD                                00000000
RP0                               00000005
RP1                               00000006
SECONDS_DISPLAY                   00000024
SECONDS_INCREMENT                 00000024
SETUP                             00000041
SPLIT_HOURS                       0000007B
SPLIT_HOURS_BORROW                00000088
SPLIT_HOURS_LOOP                  0000007E
SPLIT_HOURS_ZERO                  00000086
SPLIT_MINUTES                     0000006B
SPLIT_MINUTES_BORROW              00000078
SPLIT_MINUTES_LOOP                0000006E
SPLIT_MINUTES_ZERO                00000076
SPLIT_SECONDS                     0000005B
SPLIT_SECONDS_BORROW              00000068
SPLIT_SECONDS_LOOP                0000005E
SPLIT_SECONDS_ZERO                00000066
STATUS                            00000003
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISB                             00000086
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
W                                 00000000
WR                                00000001
WREN                              00000002
WRERR                             00000003
Z                                 00000002
_CONFIG                           00002007
_CP_OFF                           00003FFF
_CP_ON                            0000000F
_DEVID1                           00002006
_FOSC_EXTRC                       00003FFF
MPASM 5.65                         RELOJ.ASM   2-29-2016  22:18:30         PAGE  9


SYMBOL TABLE
  LABEL                             VALUE 

_FOSC_HS                          00003FFE
_FOSC_LP                          00003FFC
_FOSC_XT                          00003FFD
_HS_OSC                           00003FFE
_IDLOC0                           00002000
_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_LP_OSC                           00003FFC
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDTE_OFF                         00003FFB
_WDTE_ON                          00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_XT_OSC                           00003FFD
__16F84A                          00000001
__DEBUG                           
__MPLAB_DEBUGGER_SIMULATOR        1
alarm_hours                       00000017
alarm_minutes                     00000016
delay_counter                     0000000C
hours                             00000013
hours_t                           00000014
hours_u                           00000015
minutes                           00000010
minutes_t                         00000011
minutes_u                         00000012
pclath_temp                       00000022
second_hand_on                    0000001E
seconds                           0000000D
seconds_t                         0000000E
seconds_u                         0000000F
status_temp                       00000021
w_temp                            00000020
w_temp1                           000000A0

Errors   :     0
Warnings :    28 reported,     0 suppressed
Messages :    12 reported,     0 suppressed

